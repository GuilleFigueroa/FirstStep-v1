import{b as n,s}from"./supabase-BkoPbQFX.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],y=n("circle-check",l);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],h=n("eye-off",f);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],g=n("eye",m);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],w=n("lock",d);async function _(r){try{const{data:e,error:a}=await s.auth.signUp({email:r.email,password:r.password,options:{data:{first_name:r.firstName,last_name:r.lastName,company_name:r.companyName}}});return a?{success:!1,error:a.message}:e.user?e.user.email_confirmed_at?await u(e.user,r):{success:!0,needsEmailVerification:!0,error:"Please check your email and click the verification link to complete your registration."}:{success:!1,error:"Error creating user"}}catch{return{success:!1,error:"Unexpected error during sign up"}}}async function u(r,e){const{data:a,error:t}=await s.from("profiles").insert({id:r.id,email:e.email,first_name:e.firstName,last_name:e.lastName,company_name:e.companyName,account_status:"pending"}).select().single();return t?{success:!1,error:t.message}:{success:!0,user:a}}async function k(r){try{const{data:e,error:a}=await s.auth.signInWithPassword({email:r.email,password:r.password});if(a)return{success:!1,error:a.message};if(!e.user)return{success:!1,error:"Authentication failed"};if(!e.user.email_confirmed_at)return{success:!1,error:"Please verify your email before signing in. Check your email for the verification link."};const{data:t,error:o}=await s.from("profiles").select("*").eq("id",e.user.id).single();if(o&&o.code==="PGRST116"){const c=e.user.user_metadata;return c.first_name&&c.last_name?await u(e.user,{email:e.user.email,password:"",firstName:c.first_name,lastName:c.last_name,companyName:c.company_name}):{success:!1,error:"Profile not found and missing required data to create it."}}if(o||!t)return{success:!1,error:"Profile not found"};const i=t.account_status||"pending";return i==="rejected"?(await s.auth.signOut(),{success:!1,error:t.rejection_reason||"Tu cuenta fue rechazada. Contacta al administrador para más información."}):i==="pending"?(await s.auth.signOut(),{success:!1,error:"Tu cuenta está pendiente de aprobación. Recibirás un email cuando sea aprobada."}):{success:!0,user:t}}catch{return{success:!1,error:"Unexpected error during sign in"}}}async function N(){try{const{error:r}=await s.auth.signOut();return r?{success:!1,error:r.message}:{success:!0}}catch{return{success:!1,error:"Unexpected error during sign out"}}}async function E(){try{const{data:{user:r}}=await s.auth.getUser();if(!r)return null;const{data:e}=await s.from("profiles").select("*").eq("id",r.id).single();return e}catch{return null}}async function P(r){try{const{error:e}=await s.auth.resetPasswordForEmail(r,{redirectTo:`${window.location.origin}/reset-password`});return e?{success:!1,error:e.message}:{success:!0}}catch{return{success:!1,error:"Error al solicitar recuperación de contraseña"}}}async function x(r){try{const{error:e}=await s.auth.updateUser({password:r});return e?{success:!1,error:e.message}:{success:!0}}catch{return{success:!1,error:"Error al actualizar contraseña"}}}export{y as C,g as E,w as L,h as a,k as b,N as c,E as g,P as r,_ as s,x as u};
