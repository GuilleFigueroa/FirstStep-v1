import{j as x}from"./index-BhE2N5t8.js";import{c as w,S as M,l as N,b as l,s as c}from"./supabase-B0gnsupI.js";function W({className:o,...t}){return x.jsx("textarea",{"data-slot":"textarea",className:w("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",o),...t})}const P=N("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function G({className:o,variant:t,asChild:r=!1,...e}){const s=r?M:"span";return x.jsx(s,{"data-slot":"badge",className:w(P({variant:t}),o),...e})}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],J=l("arrow-left",S);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],K=l("chevron-left",$);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Y=l("chevron-right",U);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Z=l("circle-alert",T);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],X=l("circle-check-big",D);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],ee=l("clock",z);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],re=l("download",R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],te=l("file-text",V);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],se=l("linkedin",L);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],oe=l("mail",A);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],ae=l("message-square",B);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ce=l("send",O);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],ne=l("upload",F);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ie=l("user",I);async function le(o){try{const t=await fetch("/api/create-process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recruiterId:o.recruiterId,jobTitle:o.jobTitle,companyName:o.companyName,description:o.profile.title,mandatoryRequirements:o.profile.mandatoryRequirements,optionalRequirements:o.profile.optionalRequirements,customPrompt:o.profile.customPrompt,candidateLimit:o.candidateLimit,formQuestions:o.profile.formQuestions})}),r=await t.json();return!t.ok||!r.success?{success:!1,error:r.error||"Error al crear el proceso"}:{success:!0,process:r.process}}catch(t){return console.error("Unexpected error creating process:",t),{success:!1,error:"Error de conexión al crear el proceso"}}}async function de(o){try{const{data:t,error:r}=await c.from("processes").select("*").eq("recruiter_id",o).order("created_at",{ascending:!1});if(r)return console.error("Error fetching processes:",r),{success:!1,error:r.message};if(t&&t.length>0){const e=t.map(d=>d.id),{data:s,error:a}=await c.from("candidates").select("process_id").in("process_id",e).eq("status","completed");a&&console.error("Error fetching candidate counts:",a);const i={};return s?.forEach(d=>{i[d.process_id]=(i[d.process_id]||0)+1}),{success:!0,processes:t.map(d=>({...d,candidate_count:i[d.id]||0}))}}return{success:!0,processes:t||[]}}catch(t){return console.error("Unexpected error fetching processes:",t),{success:!1,error:"Error inesperado al obtener procesos"}}}async function ue(o){try{const{data:t,error:r}=await c.from("processes").select(`
        *,
        recruiter:profiles!recruiter_id (
          first_name,
          last_name
        )
      `).eq("status","active").like("unique_link",`%/apply/${o}`);if(r)return console.error("Error fetching process by unique link:",r),{success:!1,error:"Proceso no encontrado o inactivo"};if(!t||t.length===0)return{success:!1,error:"Proceso no encontrado o inactivo"};const e=t[0],s=e.recruiter,a=s?`${s.first_name} ${s.last_name}`:e.company_name;return{success:!0,process:{...e,recruiter_name:a}}}catch(t){return console.error("Unexpected error fetching process:",t),{success:!1,error:"Error inesperado al obtener el proceso"}}}async function pe(o,t){try{const{data:r,error:e}=await c.from("processes").update({status:t,updated_at:new Date().toISOString()}).eq("id",o).select().single();return e?(console.error("Error updating process status:",e),{success:!1,error:e.message}):{success:!0,process:r}}catch(r){return console.error("Unexpected error updating process:",r),{success:!1,error:"Error inesperado al actualizar proceso"}}}async function fe(o,t){try{const{data:r,error:e}=await c.from("processes").update({candidate_limit:t,updated_at:new Date().toISOString()}).eq("id",o).select().single();return e?(console.error("Error updating process limit:",e),{success:!1,error:e.message}):{success:!0,process:r}}catch(r){return console.error("Unexpected error updating process limit:",r),{success:!1,error:"Error inesperado al actualizar límite"}}}async function he(o,t){try{const r=await fetch("/api/delete-process",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({processId:o,recruiterId:t})}),e=await r.json();return!r.ok||!e.success?{success:!1,error:e.error||"Error al eliminar el proceso"}:{success:!0,deletedCandidates:e.deletedCandidates||0,deletedCVs:e.deletedCVs||0}}catch(r){return console.error("Delete process error:",r),{success:!1,error:"Error de conexión al eliminar proceso"}}}async function ge(o){try{const{data:t,error:r}=await c.from("processes").select("*").eq("id",o).single();if(r)return console.error("Error fetching process:",r),{success:!1,error:r.message};const{count:e,error:s}=await c.from("candidates").select("*",{count:"exact",head:!0}).eq("process_id",o).eq("status","completed");return s&&console.error("Error fetching candidate count:",s),{success:!0,process:{...t,candidate_count:e||0}}}catch(t){return console.error("Unexpected error fetching process:",t),{success:!1,error:"Error inesperado al obtener proceso"}}}async function ye(o){try{const{data:t,error:r}=await c.from("processes").select("id, status, created_at").eq("recruiter_id",o);return r?(console.error("Error fetching process stats:",r),{success:!1,error:r.message}):{success:!0,stats:{total:t?.length||0,active:t?.filter(s=>s.status==="active").length||0,closed:t?.filter(s=>s.status==="closed").length||0,paused:t?.filter(s=>s.status==="paused").length||0,thisMonth:t?.filter(s=>{const a=new Date(s.created_at),i=new Date;return a.getMonth()===i.getMonth()&&a.getFullYear()===i.getFullYear()}).length||0}}}catch(t){return console.error("Unexpected error fetching stats:",t),{success:!1,error:"Error inesperado al obtener estadísticas"}}}class E{static BUCKET_NAME="candidate-cvs";static async uploadCV(t,r){try{const e=t.name.replace(/[^a-zA-Z0-9.-]/g,"_").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),s=`${r}-${Date.now()}-${e}`,{data:a,error:i}=await c.storage.from(this.BUCKET_NAME).upload(s,t);return i?(console.error("Error uploading CV:",i),null):a.path}catch(e){return console.error("Storage service error:",e),null}}static getPublicUrl(t){const{data:r}=c.storage.from(this.BUCKET_NAME).getPublicUrl(t);return r.publicUrl}static extractPathFromUrl(t){try{const r=`/storage/v1/object/public/${this.BUCKET_NAME}/`,s=new URL(t).pathname,a=s.indexOf(r);return a===-1?null:s.substring(a+r.length)}catch(r){return console.error("Error extracting path from URL:",r),null}}static async deleteCV(t){try{const r=this.extractPathFromUrl(t);if(!r)return console.error("Could not extract file path from URL:",t),!1;const{error:e}=await c.storage.from(this.BUCKET_NAME).remove([r]);return e?(console.error("Error deleting CV from storage:",e),!1):!0}catch(r){return console.error("Storage delete error:",r),!1}}}class me{static async checkDuplicateCandidate(t,r,e){try{const{data:s}=await c.from("candidates").select("email").eq("process_id",t).eq("email",r).limit(1);if(s&&s.length>0)return{isDuplicate:!0,reason:"Ya te registraste en este proceso con este email"};if(e){const{data:a}=await c.from("candidates").select("linkedin_url").eq("process_id",t).eq("linkedin_url",e).limit(1);if(a&&a.length>0)return{isDuplicate:!0,reason:"Ya te registraste en este proceso con este LinkedIn"}}return{isDuplicate:!1}}catch(s){return console.error("Error checking duplicate candidate:",s),{isDuplicate:!1}}}static async createCandidate(t){try{const r=await this.checkDuplicateCandidate(t.process_id,t.email,t.linkedin_url);if(r.isDuplicate)return console.error("Duplicate candidate:",r.reason),null;const{data:e,error:s}=await c.from("candidates").insert({...t,status:"registered"}).select().single();return s?(console.error("Error creating candidate:",s.message,s.details,s.hint),null):e}catch(r){return console.error("Candidate service error:",r),null}}static async updateCandidateCV(t,r){try{const e=await E.uploadCV(r,t);if(!e)return!1;const s=E.getPublicUrl(e),{error:a}=await c.from("candidates").update({cv_url:s,status:"cv_uploaded"}).eq("id",t);return a?(console.error("Error updating candidate CV:",a),!1):!0}catch(e){return console.error("Update CV error:",e),!1}}static async rejectCandidate(t,r){try{const{error:e}=await c.from("candidates").update({status:"rejected",rejection_reason:r}).eq("id",t);return e?(console.error("Error rejecting candidate:",e),!1):!0}catch(e){return console.error("Reject candidate error:",e),!1}}static async analyzeCVWithAI(t,r){try{const e=await fetch("/api/analyze-cv",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:t,recruiterId:r})}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al analizar CV"}:{success:!0}}catch(e){return console.error("Analyze CV error:",e),{success:!1,error:"Error de conexión al analizar CV"}}}static async getCandidatesByRecruiter(t,r){try{const{page:e=0,limit:s=50,nameFilter:a,processFilter:i}=r||{},g=e*s,d=g+s-1,{data:f,error:m}=await c.from("processes").select("id, title, company_name, status").eq("recruiter_id",t);if(m)return console.error("Error fetching processes:",m),{success:!1,error:"Error al obtener procesos"};if(!f||f.length===0)return{success:!0,candidates:[],pagination:{page:0,limit:s,totalCount:0,totalPages:0,hasMore:!1}};const _=f.map(n=>n.id);let p=c.from("candidates").select("*",{count:"exact",head:!0}).in("process_id",_).in("status",["completed","rejected"]);a&&a.trim()&&(p=p.or(`first_name.ilike.%${a}%,last_name.ilike.%${a}%`)),i&&i.trim()&&(p=p.eq("process_id",i));const{count:h,error:v}=await p;if(v)return console.error("Error fetching candidate count:",v),{success:!1,error:"Error al contar candidatos",pagination:{page:0,limit:s,totalCount:0,totalPages:0,hasMore:!1}};let u=c.from("candidates").select("*").in("process_id",_).in("status",["completed","rejected"]);a&&a.trim()&&(u=u.or(`first_name.ilike.%${a}%,last_name.ilike.%${a}%`)),i&&i.trim()&&(u=u.eq("process_id",i)),u=u.order("created_at",{ascending:!1}).range(g,d);const{data:C,error:k}=await u;if(k)return console.error("Error fetching candidates:",k),{success:!1,error:"Error al obtener candidatos"};const q=new Map(f.map(n=>[n.id,n])),j=(C||[]).map(n=>{const y=q.get(n.process_id);return{id:n.id,first_name:n.first_name,last_name:n.last_name,email:n.email,linkedin_url:n.linkedin_url,cv_url:n.cv_url,score:n.score,status:n.status,action_status:n.action_status||"none",is_favorite:n.is_favorite||!1,created_at:n.created_at,process_id:n.process_id,process_title:y?.title||"Proceso desconocido",process_company:y?.company_name||"Empresa desconocida",process_status:y?.status||"unknown"}}),b=h&&h>0?Math.ceil(h/s):0;return{success:!0,candidates:j,pagination:{page:e,limit:s,totalCount:h||0,totalPages:b,hasMore:e<b-1}}}catch(e){return console.error("Get candidates by recruiter error:",e),{success:!1,error:"Error al cargar candidatos"}}}static async getCandidateAnalysis(t,r){try{const e=await fetch(`/api/get-candidate-analysis?candidateId=${t}&recruiterId=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al obtener análisis del candidato"}:{success:!0,data:s}}catch(e){return console.error("Get candidate analysis error:",e),{success:!1,error:"Error de conexión al obtener análisis"}}}static async updateActionStatus(t,r){try{const{error:e}=await c.from("candidates").update({action_status:r}).eq("id",t);return e?(console.error("Error updating action status:",e),!1):!0}catch(e){return console.error("Update action status error:",e),!1}}static async updateFavoriteStatus(t,r){try{const{error:e}=await c.from("candidates").update({is_favorite:r}).eq("id",t);return e?(console.error("Error updating favorite status:",e),!1):!0}catch(e){return console.error("Update favorite status error:",e),!1}}static async saveFeedback(t,r){try{const{error:e}=await c.from("candidates").update({candidate_feedback:r}).eq("id",t);return e?(console.error("Error saving candidate feedback:",e),!1):!0}catch(e){return console.error("Save feedback error:",e),!1}}static async deleteCandidate(t,r){try{const e=await fetch("/api/delete-candidate",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:t,recruiterId:r})}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al eliminar el candidato"}:{success:!0}}catch(e){return console.error("Delete candidate error:",e),{success:!1,error:"Error de conexión al eliminar candidato"}}}}class _e{static async getRecruiterQuestionsByProcess(t){try{const r=await fetch(`/api/recruiter-questions?processId=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}),e=await r.json();return!r.ok||!e.success?(console.error("Error fetching recruiter questions:",e.error),{success:!1,error:e.error||"Error al obtener preguntas"}):{success:!0,questions:e.questions||[]}}catch(r){return console.error("Get recruiter questions error:",r),{success:!1,error:"Error inesperado al obtener preguntas"}}}static async hasRecruiterQuestions(t){try{const r=await this.getRecruiterQuestionsByProcess(t);return r.success&&(r.questions?.length||0)>0}catch(r){return console.error("Has recruiter questions error:",r),!1}}static async saveRecruiterAnswers(t,r){try{const e=await fetch("/api/recruiter-questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:t,answers:r})}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al guardar respuestas del formulario"}:{success:!0}}catch(e){return console.error("Save recruiter answers error:",e),{success:!1,error:"Error de conexión al guardar respuestas del formulario"}}}}export{J as A,G as B,X as C,re as D,te as F,se as L,oe as M,_e as R,ce as S,W as T,ie as U,Z as a,Y as b,le as c,ee as d,ne as e,ae as f,me as g,K as h,ge as i,fe as j,de as k,he as l,ye as m,ue as n,pe as u};
