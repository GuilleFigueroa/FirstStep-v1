import{j as w}from"./index-VrUS_e50.js";import{c as x,S as $,l as M,b as l,s as c}from"./supabase-Bp6iRfyu.js";function W({className:o,...r}){return w.jsx("textarea",{"data-slot":"textarea",className:x("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",o),...r})}const N=M("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function G({className:o,variant:r,asChild:t=!1,...e}){const s=t?$:"span";return w.jsx(s,{"data-slot":"badge",className:x(N({variant:r}),o),...e})}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],K=l("arrow-left",P);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],J=l("chevron-left",S);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Y=l("chevron-right",U);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Z=l("circle-alert",D);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],X=l("circle-check-big",T);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],ee=l("clock",z);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],re=l("download",L);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],te=l("file-text",V);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],se=l("linkedin",R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],oe=l("mail",A);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],ae=l("message-square",B);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ce=l("send",I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],ne=l("upload",F);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ie=l("user",O);async function le(o){try{const r=`${o.companyName.toLowerCase().replace(/\s+/g,"-")}-${o.jobTitle.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,t=`${window.location.origin}/apply/${r}`,e={recruiter_id:o.recruiterId,title:o.jobTitle,company_name:o.companyName,description:o.profile.title,mandatory_requirements:o.profile.mandatoryRequirements,optional_requirements:o.profile.optionalRequirements,custom_prompt:o.profile.customPrompt,candidate_limit:o.candidateLimit,status:"active",unique_link:t},{data:s,error:a}=await c.from("processes").insert(e).select().single();if(a)return console.error("Error creating process:",a),{success:!1,error:a.message};if(o.profile.formQuestions&&o.profile.formQuestions.length>0){const n=o.profile.formQuestions.map((u,f)=>({process_id:s.id,question_text:u.question,question_type:u.type,question_options:u.options||null,question_order:f+1})),{error:p}=await c.from("recruiter_questions").insert(n);p&&console.error("Error inserting recruiter questions:",p)}return{success:!0,process:s}}catch(r){return console.error("Unexpected error creating process:",r),{success:!1,error:"Error inesperado al crear el proceso"}}}async function ue(o){try{const{data:r,error:t}=await c.from("processes").select("*").eq("recruiter_id",o).order("created_at",{ascending:!1});if(t)return console.error("Error fetching processes:",t),{success:!1,error:t.message};if(r&&r.length>0){const e=r.map(u=>u.id),{data:s,error:a}=await c.from("candidates").select("process_id").in("process_id",e).eq("status","completed");a&&console.error("Error fetching candidate counts:",a);const n={};return s?.forEach(u=>{n[u.process_id]=(n[u.process_id]||0)+1}),{success:!0,processes:r.map(u=>({...u,candidate_count:n[u.id]||0}))}}return{success:!0,processes:r||[]}}catch(r){return console.error("Unexpected error fetching processes:",r),{success:!1,error:"Error inesperado al obtener procesos"}}}async function de(o){try{const{data:r,error:t}=await c.from("processes").select(`
        *,
        recruiter:profiles!recruiter_id (
          first_name,
          last_name
        )
      `).eq("status","active").like("unique_link",`%/apply/${o}`);if(t)return console.error("Error fetching process by unique link:",t),{success:!1,error:"Proceso no encontrado o inactivo"};if(!r||r.length===0)return{success:!1,error:"Proceso no encontrado o inactivo"};const e=r[0],s=e.recruiter,a=s?`${s.first_name} ${s.last_name}`:e.company_name;return{success:!0,process:{...e,recruiter_name:a}}}catch(r){return console.error("Unexpected error fetching process:",r),{success:!1,error:"Error inesperado al obtener el proceso"}}}async function pe(o,r){try{const{data:t,error:e}=await c.from("processes").update({status:r,updated_at:new Date().toISOString()}).eq("id",o).select().single();return e?(console.error("Error updating process status:",e),{success:!1,error:e.message}):{success:!0,process:t}}catch(t){return console.error("Unexpected error updating process:",t),{success:!1,error:"Error inesperado al actualizar proceso"}}}async function fe(o,r){try{const{data:t,error:e}=await c.from("processes").update({candidate_limit:r,updated_at:new Date().toISOString()}).eq("id",o).select().single();return e?(console.error("Error updating process limit:",e),{success:!1,error:e.message}):{success:!0,process:t}}catch(t){return console.error("Unexpected error updating process limit:",t),{success:!1,error:"Error inesperado al actualizar límite"}}}async function he(o,r){try{const t=await fetch("/api/delete-process",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({processId:o,recruiterId:r})}),e=await t.json();return!t.ok||!e.success?{success:!1,error:e.error||"Error al eliminar el proceso"}:{success:!0,deletedCandidates:e.deletedCandidates||0,deletedCVs:e.deletedCVs||0}}catch(t){return console.error("Delete process error:",t),{success:!1,error:"Error de conexión al eliminar proceso"}}}async function ge(o){try{const{data:r,error:t}=await c.from("processes").select("*").eq("id",o).single();if(t)return console.error("Error fetching process:",t),{success:!1,error:t.message};const{count:e,error:s}=await c.from("candidates").select("*",{count:"exact",head:!0}).eq("process_id",o).eq("status","completed");return s&&console.error("Error fetching candidate count:",s),{success:!0,process:{...r,candidate_count:e||0}}}catch(r){return console.error("Unexpected error fetching process:",r),{success:!1,error:"Error inesperado al obtener proceso"}}}async function me(o){try{const{data:r,error:t}=await c.from("processes").select("id, status, created_at").eq("recruiter_id",o);return t?(console.error("Error fetching process stats:",t),{success:!1,error:t.message}):{success:!0,stats:{total:r?.length||0,active:r?.filter(s=>s.status==="active").length||0,closed:r?.filter(s=>s.status==="closed").length||0,paused:r?.filter(s=>s.status==="paused").length||0,thisMonth:r?.filter(s=>{const a=new Date(s.created_at),n=new Date;return a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()}).length||0}}}catch(r){return console.error("Unexpected error fetching stats:",r),{success:!1,error:"Error inesperado al obtener estadísticas"}}}class E{static BUCKET_NAME="candidate-cvs";static async uploadCV(r,t){try{const e=r.name.replace(/[^a-zA-Z0-9.-]/g,"_").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),s=`${t}-${Date.now()}-${e}`,{data:a,error:n}=await c.storage.from(this.BUCKET_NAME).upload(s,r);return n?(console.error("Error uploading CV:",n),null):a.path}catch(e){return console.error("Storage service error:",e),null}}static getPublicUrl(r){const{data:t}=c.storage.from(this.BUCKET_NAME).getPublicUrl(r);return t.publicUrl}static extractPathFromUrl(r){try{const t=`/storage/v1/object/public/${this.BUCKET_NAME}/`,s=new URL(r).pathname,a=s.indexOf(t);return a===-1?null:s.substring(a+t.length)}catch(t){return console.error("Error extracting path from URL:",t),null}}static async deleteCV(r){try{const t=this.extractPathFromUrl(r);if(!t)return console.error("Could not extract file path from URL:",r),!1;const{error:e}=await c.storage.from(this.BUCKET_NAME).remove([t]);return e?(console.error("Error deleting CV from storage:",e),!1):!0}catch(t){return console.error("Storage delete error:",t),!1}}}class ye{static async checkDuplicateCandidate(r,t,e){try{const{data:s}=await c.from("candidates").select("email").eq("process_id",r).eq("email",t).limit(1);if(s&&s.length>0)return{isDuplicate:!0,reason:"Ya te registraste en este proceso con este email"};if(e){const{data:a}=await c.from("candidates").select("linkedin_url").eq("process_id",r).eq("linkedin_url",e).limit(1);if(a&&a.length>0)return{isDuplicate:!0,reason:"Ya te registraste en este proceso con este LinkedIn"}}return{isDuplicate:!1}}catch(s){return console.error("Error checking duplicate candidate:",s),{isDuplicate:!1}}}static async createCandidate(r){try{const t=await this.checkDuplicateCandidate(r.process_id,r.email,r.linkedin_url);if(t.isDuplicate)return console.error("Duplicate candidate:",t.reason),null;const{data:e,error:s}=await c.from("candidates").insert({...r,status:"registered"}).select().single();return s?(console.error("Error creating candidate:",s.message,s.details,s.hint),null):e}catch(t){return console.error("Candidate service error:",t),null}}static async updateCandidateCV(r,t){try{const e=await E.uploadCV(t,r);if(!e)return!1;const s=E.getPublicUrl(e),{error:a}=await c.from("candidates").update({cv_url:s,status:"cv_uploaded"}).eq("id",r);return a?(console.error("Error updating candidate CV:",a),!1):!0}catch(e){return console.error("Update CV error:",e),!1}}static async rejectCandidate(r,t){try{const{error:e}=await c.from("candidates").update({status:"rejected",rejection_reason:t}).eq("id",r);return e?(console.error("Error rejecting candidate:",e),!1):!0}catch(e){return console.error("Reject candidate error:",e),!1}}static async analyzeCVWithAI(r,t){try{const e=await fetch("/api/analyze-cv",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:r,recruiterId:t})}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al analizar CV"}:{success:!0}}catch(e){return console.error("Analyze CV error:",e),{success:!1,error:"Error de conexión al analizar CV"}}}static async getCandidatesByRecruiter(r,t){try{const{page:e=0,limit:s=50,nameFilter:a,processFilter:n}=t||{},p=e*s,u=p+s-1,{data:f,error:y}=await c.from("processes").select("id, title, company_name, status").eq("recruiter_id",r);if(y)return console.error("Error fetching processes:",y),{success:!1,error:"Error al obtener procesos"};if(!f||f.length===0)return{success:!0,candidates:[],pagination:{page:0,limit:s,totalCount:0,totalPages:0,hasMore:!1}};const _=f.map(i=>i.id);let h=c.from("candidates").select("*",{count:"exact",head:!0}).in("process_id",_).in("status",["completed","rejected"]);a&&a.trim()&&(h=h.or(`first_name.ilike.%${a}%,last_name.ilike.%${a}%`)),n&&n.trim()&&(h=h.eq("process_id",n));const{count:g,error:v}=await h;if(v)return console.error("Error fetching candidate count:",v),{success:!1,error:"Error al contar candidatos",pagination:{page:0,limit:s,totalCount:0,totalPages:0,hasMore:!1}};let d=c.from("candidates").select("*").in("process_id",_).in("status",["completed","rejected"]);a&&a.trim()&&(d=d.or(`first_name.ilike.%${a}%,last_name.ilike.%${a}%`)),n&&n.trim()&&(d=d.eq("process_id",n)),d=d.order("created_at",{ascending:!1}).range(p,u);const{data:C,error:k}=await d;if(k)return console.error("Error fetching candidates:",k),{success:!1,error:"Error al obtener candidatos"};const q=new Map(f.map(i=>[i.id,i])),j=(C||[]).map(i=>{const m=q.get(i.process_id);return{id:i.id,first_name:i.first_name,last_name:i.last_name,email:i.email,linkedin_url:i.linkedin_url,cv_url:i.cv_url,score:i.score,status:i.status,action_status:i.action_status||"none",is_favorite:i.is_favorite||!1,created_at:i.created_at,process_id:i.process_id,process_title:m?.title||"Proceso desconocido",process_company:m?.company_name||"Empresa desconocida",process_status:m?.status||"unknown"}}),b=g&&g>0?Math.ceil(g/s):0;return{success:!0,candidates:j,pagination:{page:e,limit:s,totalCount:g||0,totalPages:b,hasMore:e<b-1}}}catch(e){return console.error("Get candidates by recruiter error:",e),{success:!1,error:"Error al cargar candidatos"}}}static async getCandidateAnalysis(r,t){try{const e=await fetch(`/api/get-candidate-analysis?candidateId=${r}&recruiterId=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al obtener análisis del candidato"}:{success:!0,data:s}}catch(e){return console.error("Get candidate analysis error:",e),{success:!1,error:"Error de conexión al obtener análisis"}}}static async updateActionStatus(r,t){try{const{error:e}=await c.from("candidates").update({action_status:t}).eq("id",r);return e?(console.error("Error updating action status:",e),!1):!0}catch(e){return console.error("Update action status error:",e),!1}}static async updateFavoriteStatus(r,t){try{const{error:e}=await c.from("candidates").update({is_favorite:t}).eq("id",r);return e?(console.error("Error updating favorite status:",e),!1):!0}catch(e){return console.error("Update favorite status error:",e),!1}}static async saveFeedback(r,t){try{const{error:e}=await c.from("candidates").update({candidate_feedback:t}).eq("id",r);return e?(console.error("Error saving candidate feedback:",e),!1):!0}catch(e){return console.error("Save feedback error:",e),!1}}static async deleteCandidate(r,t){try{const e=await fetch("/api/delete-candidate",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:r,recruiterId:t})}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al eliminar el candidato"}:{success:!0}}catch(e){return console.error("Delete candidate error:",e),{success:!1,error:"Error de conexión al eliminar candidato"}}}}class _e{static async getRecruiterQuestionsByProcess(r){try{const t=await fetch(`/api/get-recruiter-questions?processId=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}}),e=await t.json();return!t.ok||!e.success?(console.error("Error fetching recruiter questions:",e.error),{success:!1,error:e.error||"Error al obtener preguntas"}):{success:!0,questions:e.questions||[]}}catch(t){return console.error("Get recruiter questions error:",t),{success:!1,error:"Error inesperado al obtener preguntas"}}}static async hasRecruiterQuestions(r){try{const t=await this.getRecruiterQuestionsByProcess(r);return t.success&&(t.questions?.length||0)>0}catch(t){return console.error("Has recruiter questions error:",t),!1}}static async saveRecruiterAnswers(r,t){try{const e=await fetch("/api/save-recruiter-answers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:r,answers:t})}),s=await e.json();return!e.ok||!s.success?{success:!1,error:s.error||"Error al guardar respuestas del formulario"}:{success:!0}}catch(e){return console.error("Save recruiter answers error:",e),{success:!1,error:"Error de conexión al guardar respuestas del formulario"}}}}export{K as A,G as B,X as C,re as D,te as F,se as L,oe as M,_e as R,ce as S,W as T,ie as U,Z as a,Y as b,le as c,ee as d,ne as e,ae as f,ye as g,J as h,ge as i,fe as j,ue as k,he as l,me as m,de as n,pe as u};
